{
  "hash": "d8a36351e2e2a1c6af61e6d2c94ec8a8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Test to read data from WFS server with sf\"\nauthor: Nicolas Roelandt\ndate: today\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.3.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttachement du package : 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLes objets suivants sont masqués depuis 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLes objets suivants sont masqués depuis 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwfs_url <- \"WFS:https://data.geopf.fr/wfs/wfs?service=wfs&version=2.0.0&REQUEST=GetFeature&TYPENAME=BDTOPO_V3:batiment&BBOX=47.198,-1.575,47.213,-1.522&outputFormat=application/json\"\n\ndata_wgs84 <- st_read(dsn = wfs_url) |>\n    tibble::rowid_to_column() |> dplyr::select(rowid)# keep only ID\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `BDTOPO_V3:batiment' from data source \n  `WFS:https://data.geopf.fr/wfs/wfs?service=wfs&version=2.0.0&REQUEST=GetFeature&TYPENAME=BDTOPO_V3:batiment&BBOX=47.198,-1.575,47.213,-1.522&outputFormat=application/json' \n  using driver `WFS'\nSimple feature collection with 4176 features and 29 fields\nGeometry type: MULTIPOLYGON\nDimension:     XYZ\nBounding box:  xmin: 47.19709 ymin: -1.575629 xmax: 47.21347 ymax: -1.521739\nz_range:       zmin: -1000 zmax: 63.1\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nsf::st_crs(data_wgs84)['input']\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$input\n[1] \"WGS 84\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbbox <- sf::st_bbox(data_wgs84)\nbbox\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     xmin      ymin      xmax      ymax \n47.197091 -1.575629 47.213470 -1.521739 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data_wgs84) +\n    geom_sf() +\n  geom_rect(xmin = bbox['xmin'], xmax = bbox['xmax'], ymin = bbox['ymin'], ymax = bbox['ymax'], \n     fill = NA, colour = \"black\", linewidth = 1.5) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n# RGF93CC47\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_3947 <- data_wgs84 |> sf::st_transform(sf::st_crs(\"IGNF:RGF93CC47\"))\nsf::st_crs(data_3947)['input']\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$input\n[1] \"IGNF:RGF93CC47\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbbox <- sf::st_bbox(data_3947)\nbbox\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   xmin    ymin    xmax    ymax \n8096657 2042606 8102886 2050078 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data_3947) +\n    geom_sf() +\n  geom_rect(xmin = bbox['xmin'], xmax = bbox['xmax'], ymin = bbox['ymin'], ymax = bbox['ymax'], \n     fill = NA, colour = \"black\", linewidth = 1.5) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n# RGF93LAMB93\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_LAMB93 <- data_wgs84 |> sf::st_transform(sf::st_crs(\"IGNF:LAMB93\"))\nsf::st_crs(data_LAMB93)['input']\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$input\n[1] \"IGNF:LAMB93\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbbox <- sf::st_bbox(data_LAMB93)\nbbox\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   xmin    ymin    xmax    ymax \n7061736 2496037 7067901 2503474 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data_LAMB93) +\n    geom_sf() +\n  geom_rect(xmin = bbox['xmin'], xmax = bbox['xmax'], ymin = bbox['ymin'], ymax = bbox['ymax'], \n     fill = NA, colour = \"black\", linewidth = 1.5) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n# Data output\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsf::st_write(data_wgs84, dsn = 'output_data.gpkg', layer = 'data_wgs84',append=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDeleting layer `data_wgs84' using driver `GPKG'\nWriting layer `data_wgs84' to data source `output_data.gpkg' using driver `GPKG'\nWriting 4176 features with 1 fields and geometry type 3D Multi Polygon.\n```\n\n\n:::\n\n```{.r .cell-code}\nsf::st_write(data_3947, dsn = 'output_data.gpkg', layer = 'data_3947',append=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDeleting layer `data_3947' using driver `GPKG'\nWriting layer `data_3947' to data source `output_data.gpkg' using driver `GPKG'\nWriting 4176 features with 1 fields and geometry type 3D Multi Polygon.\n```\n\n\n:::\n:::\n\n\n\n\n# Session info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxfun::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nLocale:\n  LC_COLLATE=French_France.utf8  LC_CTYPE=French_France.utf8   \n  LC_MONETARY=French_France.utf8 LC_NUMERIC=C                  \n  LC_TIME=French_France.utf8    \n\nPackage version:\n  base64enc_0.1.3    bslib_0.8.0        cachem_1.1.0       class_7.3-22      \n  classInt_0.4-10    cli_3.6.3          colorspace_2.1-1   compiler_4.4.2    \n  DBI_1.2.3          digest_0.6.37      dplyr_1.1.4        e1071_1.7-16      \n  evaluate_1.0.1     fansi_1.0.6        farver_2.1.2       fastmap_1.2.0     \n  fontawesome_0.5.3  fs_1.6.5           generics_0.1.3     ggplot2_3.5.1     \n  glue_1.8.0         graphics_4.4.2     grDevices_4.4.2    grid_4.4.2        \n  gtable_0.3.6       highr_0.11         htmltools_0.5.8.1  isoband_0.2.7     \n  jquerylib_0.1.4    jsonlite_1.8.9     KernSmooth_2.23-24 knitr_1.49        \n  labeling_0.4.3     lattice_0.22.6     lifecycle_1.0.4    magrittr_2.0.3    \n  MASS_7.3.61        Matrix_1.7.1       memoise_2.0.1      methods_4.4.2     \n  mgcv_1.9.1         mime_0.12          munsell_0.5.1      nlme_3.1.166      \n  pillar_1.9.0       pkgconfig_2.0.3    proxy_0.4-27       R6_2.5.1          \n  rappdirs_0.3.3     RColorBrewer_1.1.3 Rcpp_1.0.13-1      renv_1.0.11       \n  rlang_1.1.4        rmarkdown_2.29     s2_1.1.7           sass_0.4.9        \n  scales_1.3.0       sf_1.0-19          splines_4.4.2      stats_4.4.2       \n  tibble_3.2.1       tidyselect_1.2.1   tinytex_0.54       tools_4.4.2       \n  units_0.8-5        utf8_1.2.4         utils_4.4.2        vctrs_0.6.5       \n  viridisLite_0.4.2  withr_3.0.2        wk_0.9.4           xfun_0.49         \n  yaml_2.3.10       \n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}